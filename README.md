![Catstruct](http://darkened.space/catstruct.jpg)

# Catstruct

## Таски и команды

Установка зависимостей:
```
npm i
```
Запуск сборки проекта с **отслеживанием изменений**:
```
npm start
```
Сборка проекта
```
npm build
```
Создание страницы с определнным шаблоном (по-умолчанию default):
```
npm run page pagename layoutname
```
Создание блока (создает папку с заданным именем и файлами pug/styl):
```
npm run block blockname
```
Упаковка папки `dist` в архив:
```
npm run zip
```
## Структура

```
├──app/
|	├──assets/ - ресурсы, которые используются в дальнейшем (пути сохраняются)
|	|   ├──fonts/ - шрифты
|	|   ├──images/ - картинки
|	|   ├──styles/ - скомпилированные стили и различные хелперы
|	|   |   ├──fonts.styl - подключение шрифтов (важно помнить, что путь до шрифтов остается таким же, как и в примере)
|	|   |   ├──main.styl - основной файл для компиляции, может иметь постфикс вида @ie9
|	|   |   ├──mixins.styl - примеси stylus'a
|	|   |   ├──rupture-settings.styl - настройки брейкпоинтов для rupture
|	|   |   ├──variables.styl - переменные stylus'a
|	|   |   └──sprite.styl - генерируемый файл спрайтов
|	|   └──sprites/ - папка для спрайтов (исходники для склейки)
|	|
|	├──layouts/ - шаблоны pug
|	├──blocks/ - папки с блоками (pug + styl + js)
|	|
|	├──data/ - коллекция json-файлов с данными
|	|
|	├──helpers/ - различные хелперы
|   |   └──pug/
|	|       ├──import.pug - все импорты pug зависимостей (генерируется автоматически)
|   |       └──bemto/ - БЭМ для pug
|	|
|	├──app.coffee - главный скрипт для бандла
|	|
|	└──pages/ - файлы с разметкой страниц
|
├──core/
|   ├─tasks/
|   ├─blocks-layouts/ - шаблоны для генерации блоков (сам скрипт в процессе разработки)
|   |
|   ├─create-block.js - скрипт герерации блока
|   ├─create-block-from-layout.js - скрипт герерации блока по шаблону
|   ├─fonts.js - скрипт импорта шрифтов
|   └─create-page.js - скрипт герерации страницы
|
├──catstruct.json - настройки шаблона
├──.autoprefixer - настройки автопрефиксера
└──.browsers - список браузеров, которым будет собираться "персональный" файл стилей
```

## Конфигурация шаблона

Конфигурация производится в файле `catstruct.json`.

## Поддержка `ie9` и прочих версий

Чтобы реализовать "рукописную" поддержку CSS в IE, в особенности старых браузерах, в шаболне реализовано решение:

Создаем файл `blockname@ie9.styl`, на выходе получаем `main@ie9.css`, который можно спокойно подключать через псевдо-комментарии.

Чтобы шаблон знал, какие браузеры войдут в сборку, нужно указать их список в корне лежит файл `.browsers`.

Указываем в нем список версий ie:

```
ie9 ie8
```

Создаем файлы стилей описанные выше, на выходе получим "персональные" файлы стилей, для этих браузеров.

## Создание блоков

Чтобы создать один или несколько блоков, нужно воспользоваться командой: `npm run block blockname1 blockname2 blockname3`. Чтобы подключить блок в какой-нибудь файл (страницу, шаблон или блок), можно воспользоваться следующими аргументами:

|**Аргумент**|**Значение**|
|------------|-------------|
|EXTB=blockname|Блок, в который будет сделан инклюд|
|EXTL=layoutname|Шаблон, в который будет сделан инклюд|
|EXTP=pagename|Страница, в которую будет сделан инклюд|

Чтобы инклюд был осуществлен корректно, в `pug` файлах нужно создать секцию из комментариев:

```
//- include start

//- include end
```

Внутри этой обертки будут размещены новые инклюды. **Добавлять секцию нужно только в старых файлах, файлы создаваемые с помощью скрипта уже содержат эту секцию**.

### Для чего это

Ранее, все инклюдилось в один файл, что вызывало большие задержки во время генерации, новый метод не отличается ничем от ручного инклюда.

### О шаблоне

Создание данного шаблона стало результатом вдохновения от [CSSSR Project template](https://github.com/CSSSR/csssr-project-template). Ребята, вы могете :)

Создавался около года и постепенно обрастал фичами. На данный момент, мне кажется он более-менее скомпанованным и способным приносить пользу.

А вообще, теперь и у меня есть свой велосипед!  :cat: